<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Linux, Programming, Emacs">
<meta name="viewport" content="width=device-width">
<title>Chen's blog (old posts, page 12) | Chen's blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://blog.binchen.org/index-12.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <section class="social"><ul>
<li><a href="index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="stories/about.html" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/chen_bin" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/redguardtoo" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
            
        <div class="post">
            <h1 class="title"><a href="posts/how-to-use-expand-region-el-in-emacs-efficiently/">How to use expand-region.el in Emacs efficiently</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-26T23:16:00+00:00">2013-08-26 23:16</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/how-to-use-expand-region-el-in-emacs-efficiently/#disqus_thread" data-disqus-identifier="cache/posts/how-to-use-expand-region-el-in-emacs-efficiently.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/expand/" rel="tag">expand</a></li>
           <li><a class="tag p-category" href="categories/region/" rel="tag">region</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p><a href="https://github.com/magnars/expand-region.el">expand-region.el</a> is very useful. I use it to select a code segment and keep press its expand key until the selected region expand to the desired region.
</p>

<p>
The only issue is its recommended hotkey for "er/expand-region" is "C-=". A little bit hard to press.
</p>

<p>
After marking a region by pressing "C-=", I press "=" to expand the region and "-" to contract.
</p>

<p>
As you may have noticed, I need move the right hand to press "=" or "-" so it's not quick enough.
</p>

<p>
The solution is simple, press ",xx" to select the initial region. Keep press "x" to expand. "z" to contract region because "x" "z" is close to left hand fingers.
</p>

<p>
<a href="http://www.emacswiki.org/emacs/Evil">evil-mode</a> and <a href="https://github.com/cofi/evil-leader">evil-leader</a> is required to implement this.
</p>

<p>
Here is the setup:
</p>

<pre class="prettyprint lang-lisp">
(require 'evil)
(require 'evil-leader)
(evil-mode 1) ;; enable evil-mode

(eval-after-load "evil" '(setq expand-region-contract-fast-key "z"))
(evil-leader/set-key "xx" 'er/expand-region)
</pre>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/navigateselect-html-tags-in-emacs/">Navigate/Select html tags in Emacs</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-22T00:05:00+00:00">2013-08-22 00:05</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/navigateselect-html-tags-in-emacs/#disqus_thread" data-disqus-identifier="cache/posts/navigateselect-html-tags-in-emacs.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/html/" rel="tag">html</a></li>
           <li><a class="tag p-category" href="categories/matchit/" rel="tag">matchit</a></li>
           <li><a class="tag p-category" href="categories/selection/" rel="tag">selection</a></li>
           <li><a class="tag p-category" href="categories/tag/" rel="tag">tag</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>
UPDATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2017-11-03 Fri&gt;</span></span>
</p>

<p>
Navigate/select html tags is kind of difficult. I've not found any plugin which could match Vim's <a href="http://www.vim.org/scripts/script.php?script_id=39">matchit</a>.
</p>

<p>
The most close one in Emacs is <a href="https://github.com/Fuco1/smartparens">smartparens</a>. You can check this <a href="https://plus.google.com/110954683162859211810/posts/4Hb2FUkaPsp">discussion on Google Plus</a> to get general impression.
</p>

<p>
I use  <code>sp-select-next-thing</code> from <code>smarparens</code> to select html tags. But I'm not satisfied with this command because it's picky on the location of my cursor and selection of multiple html tags is buggy.
</p>

<p>
So here is my fix, the new command <code>my-sp-select-next-thing</code> which fix all these issues.
</p>

<p>
Screen cast:
<img src="https://dl.dropboxusercontent.com/u/858862/my-sp-select-next-thing.gif" alt="my-sp-select-next-thing.gif"></p>

<p>
Here is the code to insert it into your <code>~/.emacs</code>:
</p>

<div class="org-src-container">

<pre><code class="lang-lisp">;; make sp-select-next-thing works even the cusor is in the open/close tag
;; like matchit in vim
;; @return t =&gt; start from open tag; nil start from close tag
(defun my-sp-select-next-thing (&amp;optional NUM)
  (interactive "p")
  (let* ((b (line-beginning-position))
         (e (line-end-position))
         (char (following-char))
         (p (point))
         rbeg
         rend
         (rlt t))
    ;; "&lt;" char code is 60
    ;; search backward
    (if (not (= char 60))
        (save-excursion
          (while (and (&lt;= b (point)) (not (= char 60)))
            (setq char (following-char))
            (setq p (point))
            (backward-char))))
    ;; search forward
    (if (not (= char 60))
        (save-excursion
          (while (and (&gt;= e (point)) (not (= char 60)))
            (setq char (following-char))
            (setq p (point))
            (forward-char))))
    ;; do the real thing
    (when (and (= char 60) (&lt; p e))
      (goto-char p)
      (forward-char)
      (if (= (following-char) 47)
          (progn
            ;; &lt;/
            (backward-char)
            (setq rlt nil))
        (progn
          ;; &lt; , looks fine
          (backward-char)
          (setq rlt t)))
      (sp-select-next-thing)
      (setq rbeg (region-beginning))
      (setq rend (region-end))

      (while (&gt; NUM 1)
        ;; well, sp-select-next-thing is kind of wierd
        (re-search-forward "&lt;[^!]")
        (backward-char 2)
        (sp-select-next-thing)
        (setq rend (region-end))
        (setq NUM (1- NUM)))
      (push-mark rbeg t t)
      (goto-char (1-rend)))
    rlt))
</code></pre>

</div>

<p>
Navigation is easy. After selecting the tags, press <code>C-x C-x</code> to move the focus. That's it.
</p>

<p>
For evil-mode, I write some code which simulate the famous <b>matchit</b> in vi:
</p>

<div class="org-src-container">

<pre><code class="lang-lisp">(require 'evil)

;; {{ evil-matchit
(defun my-evil-jump-item-enhanced-for-html ()
  (interactive)
  (if (or (eq major-mode 'html-mode)
          (eq major-mode 'xml-mode)
          (eq major-mode 'nxml-mode))
      (progn
        (if (not (my-sp-select-next-thing 1)) (exchange-point-and-mark))
        (deactivate-mark))
    (progn
      (evil-jump-item))))
(define-key evil-normal-state-map "%" 'my-evil-jump-item-enhanced-for-html)
;; }}
</code></pre>

</div>

<p>
Now you can press <code>%</code> in evil to jump between tags!
</p>

<p>
Requirement:
</p>

<ul class="org-ul">
<li>smartparens-1.5</li>
<li>evil-1.0.7</li>
<li>emacs-24.2.1</li>
</ul>
<p>
BTW, I also tried the web-mode-tag-match in <a href="https://github.com/fxbois/web-mode">web-mode</a> which provided similar tag match feature.
</p>

<p>
At least now (2nd October,2013) web-mode does not support <a href="http://freemarker.org/">freemarker</a> syntax. But smartparens is more tolerant to these template syntax.
</p>

<p>
UPDATE (6th Nov, 2013):
I started a new project <a href="https://github.com/redguardtoo/evil-matchit">evil-matchit</a> which is not dependent on smartparens. Please check it out. But you can still use my old code because it support more languages.
</p>

<p>
UPDATED (13rd Jan, 2014):
<a href="https://github.com/redguardtoo/evil-matchit">evil-matchit</a> is now powerful enough to replace my old tricks.
</p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/ku-gua-hu-luo-bo-chao-ji-dan-zuo-fa/">苦瓜胡萝卜炒鸡蛋做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-21T18:31:21+00:00">2013-08-21 18:31</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/ku-gua-hu-luo-bo-chao-ji-dan-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/ku-gua-hu-luo-bo-chao-ji-dan-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/carrot/" rel="tag">carrot</a></li>
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/egg/" rel="tag">egg</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>
<a href="http://www.xinshipu.com/%E8%8B%A6%E7%93%9C%E8%83%A1%E8%90%9D%E5%8D%9C%E7%85%8E%E8%9B%8B-83797.htm">菜谱</a> </li> <li>尽量切小丁 </li> <li>
<em>小火</em>煎蛋 </li> <li>我先炒了胡萝卜 </li> </ul>
<p><img src="wp-content/uploads/2013/08/wpid-bitter-melon-carrot-fried-egg.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-bitter-melon-carrot-fried-egg.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/take-bavarian-tasting-platter-at-bavarian-bier-cafe-parramatta/">Take bavarian tasting platter at Bavarian Bier Cafe Parramatta</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-19T09:29:00+00:00">2013-08-19 09:29</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/take-bavarian-tasting-platter-at-bavarian-bier-cafe-parramatta/#disqus_thread" data-disqus-identifier="cache/posts/take-bavarian-tasting-platter-at-bavarian-bier-cafe-parramatta.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/restaurant/" rel="tag">restaurant</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>
<a href="https://maps.google.com.au/maps?client=ubuntu&amp;channel=fs&amp;oe=utf-8&amp;ie=UTF8&amp;q=Bavarian+Bier+Caf%C3%A9+Parramatta&amp;fb=1&amp;gl=au&amp;hq=Bavarian+Bier+Caf%C3%A9&amp;hnear=0x6b12a318e167af4f:0x5017d681632c600,Parramatta+NSW&amp;cid=6547079215207738546&amp;t=m&amp;z=16&amp;vpsrc=0&amp;iwloc=A">Location at google map</a> </li> <li>"platter" means different kinds of foods in one big platter </li> <li>sausage is good </li> <li>$31 </li> </ul>
<p><img src="wp-content/uploads/2013/08/wpid-bavarian-tasting-platter-01.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-bavarian-tasting-platter-01.jpg"><img src="wp-content/uploads/2013/08/wpid-bavarian-tasting-platter-02.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-bavarian-tasting-platter-02.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/dou-ban-jiang-gai-jiao-fan-zuo-fa/">豆瓣酱盖交饭做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-19T09:19:11+00:00">2013-08-19 09:19</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/dou-ban-jiang-gai-jiao-fan-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/dou-ban-jiang-gai-jiao-fan-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/rice/" rel="tag">rice</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>这是<a href="http://tw.myblog.yahoo.com/jw!cGRdXLOAGRRYGVWg9Ac0AKngjaHkfTc-/article?mid=11068">菜谱</a> </li> <li>一开始油可能要多点，我的猪肉太精了，没有逼出油来 </li> <li>豆瓣酱慢慢炒 </li> </ul>
<p><img src="wp-content/uploads/2013/08/wpid-doubanjiang-rice.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-doubanjiang-rice.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/my-salad/">my salad</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-19T09:09:17+00:00">2013-08-19 09:09</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/my-salad/#disqus_thread" data-disqus-identifier="cache/posts/my-salad.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/salad/" rel="tag">salad</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p>As my friend said,this avocado sauce is better: <img src="wp-content/uploads/2013/08/wpid-avocado-salad.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-avocado-salad.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/nan-gua-zhou-zuo-fa/">南瓜粥作法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-19T08:52:00+00:00">2013-08-19 08:52</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/nan-gua-zhou-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/nan-gua-zhou-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/porridge/" rel="tag">porridge</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>三杯米,南瓜一个 </li> <li>南瓜切小块,越小越好,因为不打算煮太长时间粥,而南瓜要完全溶解 </li> <li>南瓜切皮的诀窍在于南瓜开水泡两分钟.参考<a href="http://www.youtube.com/watch?v=YShXlrDtZXo">阿基师教你切南瓜皮</a> </li> <li>米要冷水浸泡20分钟 </li> <li>放入南瓜和米后,煮开,然后到入麻油(防止粘锅底),小火烧一小时,不断搅拌粥 </li> <li>取决于口味可以加糖 </li> </ul>
<p><img src="wp-content/uploads/2013/08/wpid-pumpkin-porridge.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-pumpkin-porridge.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/niu-rou-mian-zuo-fa/">牛肉面作法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-19T08:27:51+00:00">2013-08-19 08:27</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/niu-rou-mian-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/niu-rou-mian-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/beef/" rel="tag">beef</a></li>
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/noodle/" rel="tag">noodle</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>原料:米粉,韩国人超市买牛肉片,<a href="http://www.massel.com.au/products/stock/powder/">Massel的牛肉粉</a> </li> </ul>
<p><img src="wp-content/uploads/2013/08/wpid-beef-noodle-ingredients.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-beef-noodle-ingredients.jpg"></p>
<ul>
<li>牛肉开水烫过 </li> <li>加入面,牛肉粉拌入 </li> <li>打入一个生鸡蛋 </li> </ul>
<p><img src="wp-content/uploads/2013/08/wpid-beef-noodle-finished.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/08/wpid-beef-noodle-finished.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/how-to-manage-emacs-packages/">How to manage emacs packages</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-16T22:30:00+00:00">2013-08-16 22:30</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/how-to-manage-emacs-packages/#disqus_thread" data-disqus-identifier="cache/posts/how-to-manage-emacs-packages.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p>I have 168 packages installed through Emacs package manager. And I shared my <a href="https://github.com/redguardtoo/emacs.d">emacs.d at github</a>. </p> <p> So these days I have been spending much time on solve the issues for people who use my .emacs.d. </p> <p> The root cause of most issues is the packages downloaded from <a href="http://melpa.milkbox.net">melpa</a> are not stable enough. </p> <p> That's understandable because packages hosted at melpa are built automatically from developers' git repositories. </p> <p> Now here is my solution: </p>
<ol>
<li>I use more stable packages from other repositories if possible. </li> <li>I use whitelist to explicitly list the packages I want to install from melpa. </li> </ol>
<p> White list because although packages on non-melpa are more stable, there are still some exceptions. </p> <p> For example, the package "erlang" exists both in melpa and <a href="http://marmalade-repo.org/">marmalade</a>. But only the version at melpa is usable. </p> <p> Now I need show you the code. See my <a href="https://github.com/redguardtoo/emacs.d/blob/master/init-elpa.el">init-elpa.el</a> at github for configuration. Especially the code related to variable "melpa-include-package". </p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/use-git-send-email-at-ubuntu/">Use `git send-email' at ubuntu</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-08-15T08:24:21+00:00">2013-08-15 08:24</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/use-git-send-email-at-ubuntu/#disqus_thread" data-disqus-identifier="cache/posts/use-git-send-email-at-ubuntu.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/email/" rel="tag">email</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/git/" rel="tag">git</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p> When I try to use `git send-email' at ubuntu 13.04, I get error message some perl modules are missing. </p>  <p> So here is one line command to install all missing perl modules: </p> <div class="org-src-container">
<br><pre class="prettyprint ">
<p>sudo cpan Error Net:SMTP:SSL MIME::Base64 Authen::SASL</p>
</pre>

<p></p>
</div> </div>
            </div>
        </div>
    
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-13.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-11.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="chenbin0";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2020         <a href="mailto:chenbin.sh@gmail.com">Chen Bin</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
         document.addEventListener('DOMContentLoaded', function() {
           var items = document.getElementsByClassName('timeago'), e, pd;
           for (var i = 0; i < items.length; i++) {
             e = items[i];
             pd = moment(new Date(e.getAttribute('datetime')));
             e.innerHTML = pd.fromNow();
             e.setAttribute('title', pd.format('LLLL'));
           }
         });
        </script>
</body>
</html>
