<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Linux, Programming, Emacs">
<meta name="viewport" content="width=device-width">
<title>Chen's blog (old posts, page 14) | Chen's blog</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://blog.binchen.org/index-14.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->
</head>
<body>
    <section class="social"><ul>
<li><a href="index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="stories/about.html" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/chen_bin" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/redguardtoo" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
            
        <div class="post">
            <h1 class="title"><a href="posts/my-grub2-configuration/">My grub2 configuration</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-12-31T19:09:00+00:00">2013-12-31 19:09</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/my-grub2-configuration/#disqus_thread" data-disqus-identifier="cache/posts/my-grub2-configuration.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/grub/" rel="tag">grub</a></li>
           <li><a class="tag p-category" href="categories/linux/" rel="tag">linux</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>
Content of <code>/etc/grub.d/11_windows</code>,
</p>

<div class="org-src-container">

<pre><code class="lang-ini">#!/bin/sh -e
echo "#        Adding Windows GRUB 2 menu"
cat &lt;&lt; EOF
menuentry "Windows XP" {
savedefault
insmod chain
insmod ntfs
set root=(hd0,1)
chainloader +1
}
EOF
</code></pre>

</div>

<p>
/etc/default/grub
</p>

<div class="org-src-container">

<pre><code class="lang-ini"># Copyright 1999-2013 Gentoo Foundation
# Distributed under the terms of the GNU General Public License v2
# $Header: /var/cvsroot/gentoo-x86/sys-boot/grub/files/grub.default-2,v 1.4 2013/09/21 18:10:55 floppym Exp $
#
# To populate all changes in this file you need to regenerate your
# grub configuration file afterwards:
#     'grub2-mkconfig -o /boot/grub/grub.cfg'
#
# See the grub info page for documentation on possible variables and
# their associated values. 

GRUB_DISTRIBUTOR="Gentoo"

GRUB_DEFAULT=saved
GRUB_SAVEDEFAULT=true
GRUB_HIDDEN_TIMEOUT=0
GRUB_HIDDEN_TIMEOUT_QUIET=true
GRUB_TIMEOUT=10

# Append parameters to the linux kernel command line
GRUB_CMDLINE_LINUX="libata.dma=1"

# Append parameters to the linux kernel command line for non-recovery entries
#GRUB_CMDLINE_LINUX_DEFAULT=""

# Uncomment to disable graphical terminal (grub-pc only)
#GRUB_TERMINAL=console

# The resolution used on graphical terminal.
# Note that you can use only modes which your graphic card supports via VBE.
# You can see them in real GRUB with the command `vbeinfo'.
#GRUB_GFXMODE=640x480

# Path to theme spec txt file.
# The starfield is by default provided with use truetype.
# NOTE: when enabling custom theme, ensure you have required font/etc.
#GRUB_THEME="/boot/grub/themes/starfield/theme.txt"

# Background image used on graphical terminal.
# Can be in various bitmap formats.
#GRUB_BACKGROUND="/boot/grub/mybackground.png"

# Uncomment if you don't want GRUB to pass "root=UUID=xxx" parameter to kernel
#GRUB_DISABLE_LINUX_UUID=true

# Uncomment to disable generation of recovery mode menu entries
#GRUB_DISABLE_RECOVERY=true

</code></pre>

</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/why-emacs-is-better-editor/">Why Emacs is better editor - a case study for javascript developer</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-12-15T22:02:00+00:00">2013-12-15 22:02</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/why-emacs-is-better-editor/#disqus_thread" data-disqus-identifier="cache/posts/why-emacs-is-better-editor.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/html/" rel="tag">html</a></li>
           <li><a class="tag p-category" href="categories/javascript/" rel="tag">javascript</a></li>
           <li><a class="tag p-category" href="categories/js2/" rel="tag">js2</a></li>
           <li><a class="tag p-category" href="categories/web/" rel="tag">web</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>
UPDATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2014-01-15 Wed&gt;</span></span>
</p>

<p>
Let's see an example in real life development.
</p>

<div id="outline-container-org187c9c9" class="outline-2">
<h3 id="org187c9c9">Note</h3>
<div class="outline-text-2" id="text-org187c9c9">
<p>
For people who does not get the key points of this article, here are the points:
</p>
<ul class="org-ul">
<li>Emacs has an embedded <b>javascript interpreter</b> which I extend a little bit.</li>
<li>Other editors just use external tools or regular expression to do the semantic analysis.</li>
<li>The difference of above two is bigger than the difference between machine gun and spear.</li>
</ul>
</div>
</div>

<div id="outline-container-orgd0344e8" class="outline-2">
<h3 id="orgd0344e8">Problem</h3>
<div class="outline-text-2" id="text-orgd0344e8">
<p>
I'm maintaining a big javascript file with thousands of lines of legacy code.
</p>

<p>
My most urgent issue is how to list all the functions in that javascript file and jump to the definition of specific function easily.
</p>

<p>
The modern enterprise application usually define the javascript function in some complex data structure. So most editors are not good at listing the functions.
</p>

<p>
To understand what "complex" means, let's check some code from real world application:
</p>
<div class="org-src-container">

<pre><code class="lang-javascript">$(el.completeRegistrationForm).validate({
    ignore: " :hidden",
    rules : {
        password : {
            required : function () { return $(el.password).is(":visible"); }
        },
        accountNumber : {
            required : function () {
                return $(el.accountNumber).is(":visible");
            },
            digits : true
        }
        // ... I skipped next 200 lines which are similar to above lines

    },
    messages : {
        password: {
            required : "Please input a valid password"
        },
        accountNumber: {
            required : "Please provide a valid account number",
            digits : "Please enter only digits",
        }
        // ... I skipped next 200 lines which are similar to above lines
    }
});
</code></pre>

</div>

<p>
Most editors like Sublime Text 3 cannot display the javascript functions with meaningful context in this case. All you can see is only a bunch of functions with name "required".:
<img src="wp-content/sublime-functions.png" alt="sublime-functions.png"></p>
</div>
</div>

<div id="outline-container-org5b518ad" class="outline-2">
<h3 id="org5b518ad">Solution</h3>
<div class="outline-text-2" id="text-org5b518ad">
<p>
Emacs has a <a href="http://www.emacswiki.org/emacs/Js2Mode">js2-mode</a> which is basically a javascript interpreter written in lisp. It's created by <a href="http://www.emacswiki.org/emacs/SteveYegge">Steve Yegge</a> and now maintained by <a href="https://github.com/mooz/js2-mode">mooz</a>.
</p>

<p>
Since <code>js2-mode</code> is a interpreter, basically it can do anything you want. The key point is to understand the <a href="http://en.wikipedia.org/wiki/Abstract_syntax_tree">Abstract Syntax Tree (AST)</a> defined in js2-mode.
</p>

<p>
Here is my patch to make <code>js2-mode</code> display the list of functions with correct context:
</p>

<div class="org-src-container">

<pre><code class="lang-diff">commit 56ed89bf18a6b58fd4620056288ea2ab52bd4d77
Author: Chen Bin &lt;chenbin.sh@gmail.com&gt;
Date:   Sun Dec 15 18:18:06 2013 +1100

    more hint for orphan function

diff --git a/js2-imenu-extras.el b/js2-imenu-extras.el
index e8e15a5..17bf158 100644
--- a/js2-imenu-extras.el
+++ b/js2-imenu-extras.el
@@ -174,6 +174,39 @@ prefix any functions defined inside the IIFE with the module name."
          (js2-imenu-record-module-pattern node)))
        t))))

+(defun js2-imenu-get-parent-keyname-list (node)
+  "get the list of keys of parent of node
+for example, for javascript code, {rules:{ password {required: function(){}}}}
+the return will be '(rules password)."
+  (let ((rlt '())
+        (n node))
+    (while (setq n (js2-imenu-parent-prop-node n))
+      (add-to-list 'rlt (js2-prop-node-name (js2-object-prop-node-left n)))
+      )
+    rlt
+    )
+  )
+
+(defun js2-imenu-parent-prop-node (node)
+  "for javascript code: parent-key-name:{ required:function(){} }
+we need know the  parent-key-name.
+ step1, 'required:function(){}' is the js2-object-prop-node
+ step2, '{ required:function(){} }' is the js2-object-node
+ step3, 'parent-key-name:{ required:function(){} }' is js2-object-prop-node
+"
+  (let (p2 p3)
+    ;; step 2
+    (setq p2 (js2-node-parent node))
+    ;; step 3
+    (when (and p2 (js2-object-node-p p2))
+      (setq p3 (js2-node-parent p2))
+      (if (and p3 (js2-object-prop-node-p p3))
+        p3
+        )
+      )
+    )
+  )
+
 (defun js2-imenu-record-orphan-function (node)
   "Record orphan function when it's the value of NODE.
 NODE must be `js2-object-prop-node'."
@@ -181,10 +214,15 @@ NODE must be `js2-object-prop-node'."
     (let ((fn-node (js2-object-prop-node-right node)))
       (unless (and js2-imenu-function-map
                    (gethash fn-node js2-imenu-function-map))
-        (let ((key-node (js2-object-prop-node-left node)))
-          (js2-record-imenu-entry fn-node
-                                  (list js2-imenu-other-functions-ns
-                                        (js2-prop-node-name key-node))
+        (let ((key-node (js2-object-prop-node-left node))
+              (parent-prop-node (js2-imenu-parent-prop-node node))
+              mylist
+              )
+          (setq mylist (append (js2-imenu-get-parent-keyname-list node)
+                               (list (js2-prop-node-name key-node))
+                               ))
+          (add-to-list 'mylist js2-imenu-other-functions-ns)
+          (js2-record-imenu-entry fn-node mylist
                                   (js2-node-abs-pos key-node)))))))

 (defun js2-imenu-record-module-pattern (node)
</code></pre>

</div>

<p>
I already submitted the patch to mooz so everyone will enjoy this feature in the future.
</p>

<p>
Here is the screen shot of emacs in old js2-mode, the UI is based on <a href="http://www.emacswiki.org/emacs/ImenuMode">Imenu Mode</a> and <a href="https://github.com/emacs-helm/helm">Helm</a>:
<img src="wp-content/emacs-functions.png" alt="emacs-functions.png"></p>

<p>
The screen shot after we applying the above patch: 
<img src="wp-content/emacs-functions-improved.png" alt="emacs-functions-improved.png"></p>
</div>
</div>

<div id="outline-container-org357cf53" class="outline-2">
<h3 id="org357cf53">Summary</h3>
<div class="outline-text-2" id="text-org357cf53">
<p>
That's an example of beauty of Emacs.
</p>

<p>
It gives you freedom and power. You can base your work on the top geeks like Steve Yegge and mooz. Just a few lines of lisp code to kick ass.
</p>
</div>
</div>

<div id="outline-container-orgd043e05" class="outline-2">
<h3 id="orgd043e05">Update</h3>
<div class="outline-text-2" id="text-orgd043e05">
<p>
My patch is incorporated into <code>js2-mode</code> since version <code>20140114</code>.
</p>

<p>
After installing <code>js2-mode</code>, you need paste one line setup into your <code>~/.emacs</code>,
</p>
<div class="org-src-container">

<pre><code class="lang-lisp">(js2-imenu-extras-mode)
</code></pre>

</div>

<p>
The UI to display the candidate is from package <a href="https://github.com/emacs-helm/helm">Helm</a>.
</p>

<p>
The <code>Helm</code> version should be <code>20140125.1101</code> or higher, you can install <code>Helm</code> from <a href="http://melpa.milkbox.net/">MELPA</a>.
</p>

<p>
After installing <code>Helm</code>, you can use command <code>M-x helm-imenu</code> to show the list of functions to jump to. Here is the screen shot how I use imenu in my <a href="https://github.com/redguardtoo/hello/raw/master/hello2.js">hello2.js</a>:
</p>


<div class="figure">
<p><img src="wp-content/helm-imenu-and-js2-mode-nq8.png" alt="helm-imenu-and-js2-mode-nq8.png"></p>
</div>

<p>
UPDATE: I suggest using <code>counsel-imenu</code> from <a href="https://github.com/abo-abo/swiper">Counsel</a> instead of <code>Helm</code>.
</p>
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/hao-you-shen-cai-zuo-fa/">蚝油生菜做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-11-17T19:43:00+00:00">2013-11-17 19:43</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/hao-you-shen-cai-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/hao-you-shen-cai-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/beef/" rel="tag">beef</a></li>
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/garlic/" rel="tag">garlic</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>
<a href="http://www.xinshipu.com/%E7%AE%80%E6%98%93%E7%89%88%E8%9A%9D%E6%B2%B9%E7%94%9F%E8%8F%9C-15533.htm">菜谱</a> </li> <li>油炸蒜末,倒入蚝油(至少4大勺)搅拌,最后放入生菜(半颗),搅拌一下即可,可以最后放盐如果嫌不咸的话 </li> <li>生菜用开水烫过沥干,因为其容易出水 </li> <li>不要放糖,蚝油本身有甜味了 </li> </ul>
<p>阿基师的做法 </p>   <pre class="example">小叮嚀:
<p>1.西生菜要集中加熱（顏色才可以保持鮮綠跟脆口）</p>
<p>2.可以利用香菇去蠔油腥味</p>
<p>2.1. 利用香菇去做燴的動作，讓一些物料巴在上頭</p>
<p>2.2. 不要加雞精粉跟糖，蠔油已經有甜度了。</p>
<p>2.3. 蠔油跟豬油一起拌會更香</p>
<p>做法:</p>
<p>1.去除香菇蒂頭，斜刀將香菇切片。</p>
<p>2.起鍋下1茶匙油，爆香香菇片，下蠔油拌炒〈炒過的蠔油有焦糖味在裡面， 味道會更香〉，加入自來高湯〈自來高湯的量，只要抓蠔油鹹度即可〉，小滾一會兒， 讓香菇的甜味煮出來。</p>
<p>3.調太白粉水〈粉1：水3〉，加入適量的太白粉水，加入少許香油，不需攪拌，熄火 〈澱粉會吃油，攪拌的話會膨脹變成一團糊〉。</p>
<p>4.在滾水鍋中加鹽，汆燙西生菜〈菜要最後汆燙〉，加入少許薑末〈薑汁也行，薑可提味，巴在葉片上會更好吃〉汆燙，撈起西生菜瀝乾水份〈因為西生菜很會出水， 一定要徹底瀝乾水份，否則會水水的〉。</p>
<p>5.將蠔油醬汁淋在西生菜上即可。</p>
<p></p></pre>  <p> -<a href="http://www.youtube.com/watch?feature=player_detailpage&amp;v=X5fY_CtpUGo#t=1731">阿基师视频</a> </p> <p> Screen shot: <img src="wp-content/uploads/2013/11/wpid-fried-cabbage.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/11/wpid-fried-cabbage.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/notes-on-upgrading-gentoo-linux/">notes on upgrading Gentoo Linux</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-26T19:47:54+00:00">2013-10-26 19:47</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/notes-on-upgrading-gentoo-linux/#disqus_thread" data-disqus-identifier="cache/posts/notes-on-upgrading-gentoo-linux.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/gentoo/" rel="tag">gentoo</a></li>
           <li><a class="tag p-category" href="categories/linux/" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="categories/upgrade/" rel="tag">upgrade</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p></p>
<pre class="prettyprint ">
<p>sudo emerge --update --deep --with-bdeps=y --newuse world
</p></pre>
<p></p>
<ul>
<li>I get notified that some newer version package is required, so I have to manually install those package and re-run the <code>emerge world</code> </li> <li>Some package is gone (libreoffice-bin, for example). </li> </ul>
<p> Here is command to manually install package: </p>   
<pre class="prettyprint ">

sudo ebuild /usr/portage/www-client/firefox-bin/firefox-bin-23.0.ebuild unpack compile install qmerge clean
</pre>

<p></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs/">How to take screen shot for business people efficiently in Emacs</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-23T17:31:00+00:00">2013-10-23 17:31</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs/#disqus_thread" data-disqus-identifier="cache/posts/how-to-take-screen-shot-for-business-people-efficiently-in-emacs.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
           <li><a class="tag p-category" href="categories/linux/" rel="tag">linux</a></li>
           <li><a class="tag p-category" href="categories/office/" rel="tag">office</a></li>
           <li><a class="tag p-category" href="categories/org/" rel="tag">org</a></li>
           <li><a class="tag p-category" href="categories/screenshot/" rel="tag">screenshot</a></li>
           <li><a class="tag p-category" href="categories/word/" rel="tag">word</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p>
CREATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2013-10-23 Wed&gt;</span></span>
</p>

<p>
UPDATED: <span class="timestamp-wrapper"><span class="timestamp">&lt;2015-08-11 Tue&gt;</span></span>
</p>

<div id="outline-container-org3d090d5" class="outline-2">
<h3 id="org3d090d5">Tools</h3>
<div class="outline-text-2" id="text-org3d090d5">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left">
</colgroup>
<thead><tr>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-left">Description</th>
<th scope="col" class="org-left">Minimum version</th>
</tr></thead>
<tbody>
<tr>
<td class="org-left">Org-mode</td>
<td class="org-left">create org-file which could be converted to odt file</td>
<td class="org-left">7.8</td>
</tr>
<tr>
<td class="org-left">scrot</td>
<td class="org-left">command line tool to take screen shot</td>
<td class="org-left">any version</td>
</tr>
<tr>
<td class="org-left"><a href="https://www.libreoffice.org/download/libreoffice-fresh/">Libreoffice</a></td>
<td class="org-left">convert odt to Microsoft Word</td>
<td class="org-left">any version</td>
</tr>
<tr>
<td class="org-left">xsel</td>
<td class="org-left">X clipboard tool</td>
<td class="org-left">any version</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-org8e219f9" class="outline-2">
<h3 id="org8e219f9">Work flow</h3>
<div class="outline-text-2" id="text-org8e219f9">
</div>
<div id="outline-container-org3bf0cf9" class="outline-3">
<h4 id="org3bf0cf9">Use scrot to screenshot and put its path into clipboard</h4>
<div class="outline-text-3" id="text-org3bf0cf9">
<div class="org-src-container">

<pre><code class="lang-sh">scrot '%H%M%S-%d_$wx$h.png' -e 'mkdir -p ~/screenshot;mv $f ~/screenshot/;echo ~/screenshot/$f|tr -d \"\\n\"|xsel -ib;'
</code></pre>

</div>
</div>
</div>

<div id="outline-container-orgbc306e6" class="outline-3">
<h4 id="orgbc306e6">Create org file and insert path of screen shot</h4>
<div class="outline-text-3" id="text-orgbc306e6">
<p>
Actually I use below elisp command to do the insertion for me.
</p>
<div class="org-src-container">

<pre><code class="lang-lisp">(defun insert-file-link-from-clipboard ()
  "Make sure the full path of file exist in clipboard. This command will convert
The full path into relative path and insert it as a local file link in org-mode"
  (interactive)
  (let (str)
    (with-temp-buffer
      (shell-command
       (cond
        ((eq system-type 'cygwin) "getclip")
        ((eq system-type 'darwin) "pbpaste")
        (t "xsel -ob"))
       1)
      (setq str (buffer-string)))

    ;; convert to relative path (relative to current buffer) if possible
    (let ((m (string-match (file-name-directory (buffer-file-name)) str) ))
      (when m
        (if (= 0 m )
            (setq str (substring str (length (file-name-directory (buffer-file-name)))))
          ))
        (insert (format "[[file:%s]]" str)))
    ))
</code></pre>

</div>
</div>
</div>
<div id="outline-container-orgacce8a1" class="outline-3">
<h4 id="orgacce8a1">Convert org file into Microsoft Word format</h4>
<div class="outline-text-3" id="text-orgacce8a1">
<p>
I'm sure this method works even on Windows. But I don't have Windows PC to validate my belief. Libreoffice is required.
</p>

<p>
Run the command "M-x org-export-as-odt".
</p>

<p>
Word document is <b>automatically created</b> if you insert below code into your ~/.emacs:
</p>
<div class="org-src-container">

<pre><code class="lang-lisp">;; This setup is tested on Emacs 24.3 &amp; Emacs 24.4 on Linux/OSX
;; org v7 bundled with Emacs 24.3
(setq org-export-odt-preferred-output-format "doc")
;; org v8 bundled with Emacs 24.4
(setq org-odt-preferred-output-format "doc")
;; BTW, you can assign "pdf" in above variables if you prefer PDF format

;; Only OSX need below setup
(defun my-setup-odt-org-convert-process ()
  (interactive)
  (let ((cmd "/Applications/LibreOffice.app/Contents/MacOS/soffice"))
    (when (and (eq system-type 'darwin) (file-exists-p cmd))
      ;; org v7
      (setq org-export-odt-convert-processes '(("LibreOffice" "/Applications/LibreOffice.app/Contents/MacOS/soffice --headless --convert-to %f%x --outdir %d %i")))
      ;; org v8
      (setq org-odt-convert-processes '(("LibreOffice" "/Applications/LibreOffice.app/Contents/MacOS/soffice --headless --convert-to %f%x --outdir %d %i"))))
    ))
(my-setup-odt-org-convert-process)
</code></pre>

</div>

<p>
Emacs will find the binary "soffice" from libreoffice to do the conversion.
</p>
</div>
</div>

<div id="outline-container-orgaed06a4" class="outline-3">
<h4 id="orgaed06a4">Tips</h4>
<div class="outline-text-3" id="text-orgaed06a4">
<p>
If you need page break in exported document, insert below snippet into the org file:
</p>
<div class="org-src-container">

<pre><code class="lang-html">#+ODT: &lt;text:p text:style-name="PageBreak"/&gt;
</code></pre>

</div>
</div>
</div>
</div>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/how-to-use-flyspell-in-web-mode/">How to use flyspell in web-mode</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-22T08:54:00+00:00">2013-10-22 08:54</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/how-to-use-flyspell-in-web-mode/#disqus_thread" data-disqus-identifier="cache/posts/how-to-use-flyspell-in-web-mode.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <p>
Please see <a href="http://blog.binchen.org/posts/effective-spell-check-in-emacs.html">http://blog.binchen.org/posts/effective-spell-check-in-emacs.html</a> for solution.
</p>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/suan-miao-chao-niu-rou-zuo-fa/">蒜苗炒牛肉做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-19T19:53:00+00:00">2013-10-19 19:53</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/suan-miao-chao-niu-rou-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/suan-miao-chao-niu-rou-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/beef/" rel="tag">beef</a></li>
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/garlic/" rel="tag">garlic</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>
<a href="http://www.xinshipu.com/%E7%89%9B%E8%82%89%E7%82%92%E8%92%9C%E8%8B%97-83979.htm">菜谱</a> </li> <li>甜面酱本身带盐了 </li> <li>蒜苗可以大火快炒,更嫩一点 </li> </ul>
<p> <img src="wp-content/uploads/2013/10/wpid-stir-fried-beef-and-garlic-stem1.jpg" alt="lightbox"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/san-wen-yu-dun-dou-fu-zuo-fa/">三文鱼炖豆腐做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-10-02T21:15:00+00:00">2013-10-02 21:15</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/san-wen-yu-dun-dou-fu-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/san-wen-yu-dun-dou-fu-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/salmon/" rel="tag">salmon</a></li>
           <li><a class="tag p-category" href="categories/soup/" rel="tag">soup</a></li>
           <li><a class="tag p-category" href="categories/toufu/" rel="tag">toufu</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>
<a href="http://blog.sina.com.cn/s/blog_4cc524d50102dzgv.html">菜谱, 全文如下</a> </li> </ul>
<pre class="example">用料:
三文鱼、老豆腐、面粉、黑胡椒粒、甜椒、葱、
<p>大蒜、姜、松子、香菜、盐、老抽、生抽、糖。</p>
<p>做法：</p>
<p>1: 三文鱼去掉鱼骨，拔出鱼刺，和豆腐切成大小相仿的小块，</p>
<p>并用厨房纸巾稍稍擦干水份，三文鱼块里撒入适量的黑胡椒粒，</p>
<p>放入2勺面粉稍微裹以下;</p>
<p>鱼炖豆腐好吃2字诀-三文鱼炖豆腐</p>
<p>2: 其他材料备好;</p>
<p>鱼炖豆腐好吃2字诀-三文鱼炖豆腐</p>
<p>3: 锅底用姜片擦一遍，放入姜片、三文鱼2面煎黄取出，</p>
<p>再放入豆腐块煎黄;</p>
<p>鱼炖豆腐好吃2字诀-三文鱼炖豆腐</p>
<p>4: 倒入适量老抽上色，生抽、盐、糖、大蒜调味，</p>
<p>一次性倒入足量的开水，大火煮开，中火炖至快干;</p>
<p>鱼炖豆腐好吃2字诀-三文鱼炖豆腐</p>
<p>5: 放入甜椒块翻炒一下，撒入松子、香菜段即可起锅。</p>
<p>鱼炖豆腐好吃2字诀-三文鱼炖豆腐</p>
<p>小牛贴心提示：</p>
<p>1：炖豆腐和鱼，想要好吃，关键要时间，</p>
<p>即是老话所说"千滚的豆腐万滚的鱼";</p>
<p>2：鱼块裹面粉、生姜擦锅都能防止鱼不沾锅;</p>
<p>3：一次性加入足量的开水，中途不要频繁加水。</p>
<p></p></pre>  <ul>
<li>生抽至少两大勺,我放得太少 </li> <li>炖得时候我放水太少,一开始就要多放,至少半大碗水 </li> <li>鱼和豆腐煎的黄一点,一开始用纸吸干水份较好,否则油到处溅 </li> <li>老抽没有了,所以颜色很难看 </li> <li>诀窍1,黑胡椒之类的辛香料都是油炸过后才更香 </li> <li>诀窍2,如果做汤的话,鱼和豆腐炖的时间越长越好吃,也有营养 </li> </ul>
<p> <a href="http://www.meishij.net/zuofa/sanwenyudoufutang.html">另附有三文鱼豆腐汤</a>的做法 </p> <p> <img src="wp-content/uploads/2013/10/wpid-salmon-dun-doufu.jpg" alt="http://blog.binchen.org/wp-content/uploads/2013/10/wpid-salmon-dun-doufu.jpg"></p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/copy-file-name-or-full-path-of-file-in-emacs-dired-buffer-into-system-clipboard/">Copy file name or full path of file from Emacs dired buffer into system clipboard</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-09-25T20:46:00+00:00">2013-09-25 20:46</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/copy-file-name-or-full-path-of-file-in-emacs-dired-buffer-into-system-clipboard/#disqus_thread" data-disqus-identifier="cache/posts/copy-file-name-or-full-path-of-file-in-emacs-dired-buffer-into-system-clipboard.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/clipboard/" rel="tag">clipboard</a></li>
           <li><a class="tag p-category" href="categories/emacs/" rel="tag">emacs</a></li>
           <li><a class="tag p-category" href="categories/en/" rel="tag">en</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<p>Simple, insert below code into your ~/.emacs: </p>   
<pre class="prettyprint ">

;; {{ copy the file-name/full-path in dired buffer into clipboard

;; `w` =&gt; copy file name

;; `C-u 0 w` =&gt; copy full path

(defadvice dired-copy-filename-as-kill (after dired-filename-to-clipboard activate)
  (with-temp-buffer
    (insert (current-kill 0))
    (shell-command-on-region (point-min) (point-max)
                             (cond
                              ((eq system-type 'cygwin) "putclip")
                              ((eq system-type 'darwin) "pbcopy")
                              (t "xsel -ib")
                              )))
  (message "%s =&gt; clipboard" (current-kill 0))
  )
</pre>

<p></p>
<p> It support Cygwin and OSX out of the box. You need install xsel under Linux. </p> <p> BTW, I suggest installing a clipboard manager like parcellite under Linux to sync the two X clipboards. </p>
</div>
            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/fan-qie-ji-dan-tang-zuo-fa/">番茄鸡蛋汤做法</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2013-09-25T19:54:19+00:00">2013-09-25 19:54</time>
</div>
                <div class="stats">
                    
        
    <a href="posts/fan-qie-ji-dan-tang-zuo-fa/#disqus_thread" data-disqus-identifier="cache/posts/fan-qie-ji-dan-tang-zuo-fa.html">Comments</a>


                </div>
            
        <div itemprop="keywords" class="tags">
        <ul>
        Tags : 
           <li><a class="tag p-category" href="categories/cuisine/" rel="tag">cuisine</a></li>
           <li><a class="tag p-category" href="categories/soup/" rel="tag">soup</a></li>
           <li><a class="tag p-category" href="categories/zh/" rel="tag">zh</a></li>
        </ul>
</div>

            </div>
            <div class="body">
                <div>
<p></p>
<ul>
<li>放蒜(可以加姜,葱)大火爆炒,也可以加点老抽 </li> <li>放入番茄超出茄红素 </li> <li>加水煮,调味放盐糖 </li> <li>最后放入打碎鸡蛋,五秒钟后起锅 </li> </ul>
<p>有人介绍下面也是类似原理,加葱花老抽爆炒,然后放水煮面 </p>
</div>
            </div>
        </div>
    
        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index-15.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-13.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="chenbin0";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><footer id="footer"><p>Contents © 2020         <a href="mailto:chenbin.sh@gmail.com">Chen Bin</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
         document.addEventListener('DOMContentLoaded', function() {
           var items = document.getElementsByClassName('timeago'), e, pd;
           for (var i = 0; i < items.length; i++) {
             e = items[i];
             pd = moment(new Date(e.getAttribute('datetime')));
             e.innerHTML = pd.fromNow();
             e.setAttribute('title', pd.format('LLLL'));
           }
         });
        </script>
</body>
</html>
